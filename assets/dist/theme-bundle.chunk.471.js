"use strict";(self.webpackChunkHalo=self.webpackChunkHalo||[]).push([[471],{30471:(t,e,r)=>{r.r(e),r.d(e,{default:()=>m});var a=r(4621),n=r(57792),o=r(13228),i=r(96609),s=r(56526),c=r(88835),d=r(65117),l=(r(77462),r(41582)),u=r(76970),h=r(80156),g=r(12946),p=r(33270);function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=Array(e);r<e;r++)a[r]=t[r];return a}function v(t,e){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},v(t,e)}var m=function(t){function e(){return t.apply(this,arguments)||this}var r,n;n=t,(r=e).prototype=Object.create(n.prototype),r.prototype.constructor=r,v(r,n);var m=e.prototype;return m.formatCategoryTreeForJSTree=function(t){var e=this,r={text:t.data,id:t.metadata.id,state:{selected:t.selected}};return t.state&&(r.state.opened="open"===t.state,r.children=!0),t.children&&(r.children=[],t.children.forEach((function(t){r.children.push(e.formatCategoryTreeForJSTree(t))}))),r},m.showProducts=function(t){if(void 0===t&&(t=!0),this.$productListingContainer.removeClass("u-hidden"),this.$facetedSearchContainer.removeClass("u-hidden"),this.$contentResultsContainer.addClass("u-hidden"),p("[data-content-results-toggle]").removeClass("navBar-action-color--active"),p("[data-content-results-toggle]").addClass("navBar-action"),p("[data-product-results-toggle]").removeClass("navBar-action"),p("[data-product-results-toggle]").addClass("navBar-action-color--active"),this.activateTab(p("[data-product-results-toggle]")),t){var e=p("#search-results-product-count span").data(),r=e.count>0?e.url:s.A.replaceParams(e.url,{page:1});s.A.goToUrl(r)}},m.showContent=function(t){if(void 0===t&&(t=!0),this.$contentResultsContainer.removeClass("u-hidden"),this.$productListingContainer.addClass("u-hidden"),this.$facetedSearchContainer.addClass("u-hidden"),p("[data-product-results-toggle]").removeClass("navBar-action-color--active"),p("[data-product-results-toggle]").addClass("navBar-action"),p("[data-content-results-toggle]").removeClass("navBar-action"),p("[data-content-results-toggle]").addClass("navBar-action-color--active"),this.activateTab(p("[data-content-results-toggle]")),t){var e=p("#search-results-content-count span").data(),r=e.count>0?e.url:s.A.replaceParams(e.url,{page:1});s.A.goToUrl(r)}},m.activateTab=function(t){p("[data-search-page-tabs]").find('[role="tab"]').each((function(e,r){var a=p(r);if(a.is(t))return a.removeAttr("tabindex"),void a.attr("aria-selected",!0);a.attr("tabindex","-1"),a.attr("aria-selected",!1)}))},m.onTabChangeWithArrows=function(t){var e=t.which;if(37===e||39===e){var r=p("[data-search-page-tabs]").find('[role="tab"]');if(-1!==r.index(p(document.activeElement))){var a,n=p("#"+document.activeElement.id),o=r.index(n),i=r.length-1;switch(e){case 37:a=0===o?i:o-1;break;case 39:a=o===i?0:o+1}p(r.get(a)).focus().trigger("click")}}},m.onReady=function(){var t=this;this.arrangeFocusOnSortBy();var e=p("[data-advanced-search-form]"),r=e.find("[data-search-category-tree]"),n=c.parse(window.location.href,!0),o=[];this.$productListingContainer=p("#product-listing-container"),this.$facetedSearchContainer=p("#faceted-search-container"),this.$contentResultsContainer=p("#search-results-content"),p("#facetedSearch").length>0?this.initFacetedSearch():(this.onSortBySubmit=this.onSortBySubmit.bind(this),a.JL.on("sortBy-submitted",this.onSortBySubmit)),(0,d.Ay)(),p("[data-product-results-toggle]").on("click",(function(e){e.preventDefault(),t.showProducts()})),p("[data-content-results-toggle]").on("click",(function(e){e.preventDefault(),t.showContent()})),p("[data-search-page-tabs]").on("keyup",this.onTabChangeWithArrows),0===this.$productListingContainer.find("li.product").length||"content"===n.query.section?this.showContent(!1):this.showProducts(!1);var i=this.initValidation(e).bindValidation(e.find("#search_query_adv"));this.context.categoryTree.forEach((function(e){o.push(t.formatCategoryTreeForJSTree(e))})),this.categoryTreeData=o,this.createCategoryTree(r),e.on("submit",(function(t){var a=r.jstree().get_selected();if(!i.check())return t.preventDefault();e.find('input[name="category[]"]').remove();for(var n,o=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return f(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(a);!(n=o()).done;){var s=n.value,c=p("<input>",{type:"hidden",name:"category[]",value:s});e.append(c)}}));var s=p('<p\n            class="aria-description--hidden"\n            tabindex="-1"\n            role="status"\n            aria-live="polite"\n            >'+this.context.searchResultsCount+"</p>").prependTo("body");setTimeout((function(){return s.focus()}),100),(0,h.A)(),(0,g.A)(),this.showProductsPerPage(),this.loadOptionForProductCard(this.context)},m.loadTreeNodes=function(t,e){var r=this;p.ajax({url:"/remote/v1/category-tree",data:{selectedCategoryId:t.id,prefix:"category"},headers:{"x-xsrf-token":window.BCData&&window.BCData.csrf_token?window.BCData.csrf_token:""}}).done((function(t){var a=[];t.forEach((function(t){a.push(r.formatCategoryTreeForJSTree(t))})),e(a)}))},m.createCategoryTree=function(t){var e=this,r={core:{data:function(t,r){"#"===t.id?r(e.categoryTreeData):e.loadTreeNodes(t,r)},themes:{icons:!0}},checkbox:{three_state:!1},plugins:["checkbox"]};t.jstree(r)},m.initFacetedSearch=function(){var t=this,e=this.context,r=e.onMinPriceError,a=e.onMaxPriceError,n=e.minPriceNotEntered,i=e.maxPriceNotEntered,s=e.onInvalidPrice,d=p("#product-listing-container"),l=p("#search-results-content"),g=p("#faceted-search-container"),f=p("#search-results-heading"),v=p("#search-results-product-count"),m=p("#search-results-content-count"),C={template:{productListing:"search/product-listing",contentListing:"search/content-listing",sidebar:"search/sidebar",heading:"search/heading",productCount:"search/product-count",contentCount:"search/content-count"},config:{product_results:{limit:this.context.searchProductsPerPage}},showMore:"search/show-more"};this.facetedSearch=new o.A(C,(function(e){f.html(e.heading),"content"===c.parse(window.location.href,!0).query.section?(l.html(e.contentListing),m.html(e.contentCount),t.showContent(!1)):(d.html(e.productListing),g.html(e.sidebar),v.html(e.productCount),t.showProducts(!1),d.find('[data-halo-load="animation"]').length>0&&p('[data-halo-load="animation"]').addClass("animated"),p("#product-listing-container .product").length>0&&(0,u.A)(t.context,"product-listing-container"),(0,h.A)(),t.showProductsPerPage()),p("body").triggerHandler("compareReset"),window.scrollTo({top:0,behavior:"smooth"})}),{validationErrorMessages:{onMinPriceError:r,onMaxPriceError:a,minPriceNotEntered:n,maxPriceNotEntered:i,onInvalidPrice:s}})},m.initValidation=function(t){return this.$form=t,this.validator=(0,l.A)({submit:t,tap:i.dN}),this},m.bindValidation=function(t){return this.validator&&this.validator.add({selector:t,validate:"presence",errorMessage:t.data("errorMessage")}),this},m.check=function(){return!!this.validator&&(this.validator.performCheck(),this.validator.areAll("valid"))},m.loadOptionForProductCard=function(t){p("#product-listing-container .product").length>0&&(0,u.A)(t,"product-listing-container")},m.showProductsPerPage=function(){try{var t=new URL(window.location.href).searchParams.get("limit");if(t){p(".btn-show-products").removeClass("selected");var e=p('.btn-show-products[data-value="'+t+'"]');e.addClass("selected"),e.closest(".actionBar-dropdown").find(".dropdown-label").text(e.find("span").text())}}catch(t){}},e}(n.A)}}]);
//# sourceMappingURL=theme-bundle.chunk.471.js.map